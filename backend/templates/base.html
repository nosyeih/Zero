<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5', // Indigo 600
                        secondary: '#10B981', // Emerald 500
                        dark: '#1F2937', // Gray 800
                    }
                }
            }
        }
    </script>
    <!-- Favicon & PWA -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/favicon-96x96.png') }}"
        sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='images/favicon.svg') }}" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}" />
    <link rel="apple-touch-icon" sizes="180x180"
        href="{{ url_for('static', filename='images/apple-touch-icon.png') }}" />
    <meta name="apple-mobile-web-app-title" content="FinanzaApp" />
    <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>

<body
    class="bg-gray-50 text-gray-900 h-screen flex flex-col overflow-hidden font-sans selection:bg-indigo-500 selection:text-white">
    <nav class="bg-white/80 backdrop-blur-md shadow-sm z-50 border-b border-gray-100 flex-none">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center gap-3 cursor-default">
                        <div
                            class="bg-gradient-to-br from-primary to-indigo-600 text-white p-2 rounded-xl shadow-lg shadow-indigo-500/30 transform transition-transform hover:scale-105 duration-200">
                            <img src="{{ url_for('static', filename='images/favicon.svg') }}" alt="Zero logo"
                                class="w-6 h-6 object-contain">
                        </div>
                        <span class="font-bold text-2xl tracking-tight text-gray-900">Zero</span>
                    </div>
                </div>
                <div class="flex items-center">
                    {% if session.get('user_id') %}
                    <div class="flex items-center gap-2 sm:gap-4">
                        <!-- 1. Name -->
                        <div
                            class="hidden md:flex items-center gap-2 px-3 py-1.5 bg-indigo-50 rounded-full border border-indigo-100/50">
                            <div
                                class="h-6 w-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center">
                                <span class="font-bold text-[10px]">
                                    {% if user is defined and user.name %}{{ user.name[0] }}{% else %}U{% endif %}
                                </span>
                            </div>
                            <span class="text-sm font-semibold text-gray-700">
                                {% if user is defined %}{{ user.name }}{% endif %}
                            </span>
                        </div>
                        <!-- Mobile Name (Icon only) -->
                        <div
                            class="md:hidden h-8 w-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center">
                            <span class="font-bold text-xs">
                                {% if user is defined and user.name %}{{ user.name[0] }}{% else %}U{% endif %}
                            </span>
                        </div>

                        <!-- 2. Menu Dropdown -->
                        <div class="relative group z-50">
                            <button type="button"
                                class="flex items-center gap-1 text-gray-600 hover:text-indigo-600 font-medium text-sm transition-colors py-2 px-2 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-1">
                                <span>Menú</span>
                                <svg class="w-4 h-4 transform group-hover:rotate-180 transition-transform duration-200"
                                    fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </button>

                            <!-- Dropdown menu with bridge -->
                            <div
                                class="absolute right-0 top-full pt-2 w-48 focus:outline-none hidden group-hover:block z-50 animate-fade-in-up">
                                <div class="bg-white rounded-xl shadow-xl ring-1 ring-black/5 overflow-hidden p-1">
                                    <a href="{{ url_for('dashboard') }}"
                                        class="block px-4 py-2.5 text-sm text-gray-600 rounded-lg hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Inicio</a>
                                    <a href="{{ url_for('operations') }}"
                                        class="block px-4 py-2.5 text-sm text-gray-600 rounded-lg hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Finanzas</a>
                                    <a href="{{ url_for('profit_calculator') }}"
                                        class="block px-4 py-2.5 text-sm text-gray-600 rounded-lg hover:bg-green-50 hover:text-green-600 transition-colors">Rentabilidad</a>
                                    <a href="{{ url_for('utilities') }}"
                                        class="block px-4 py-2.5 text-sm text-gray-600 rounded-lg hover:bg-purple-50 hover:text-purple-600 transition-colors">Utilidades</a>
                                </div>
                            </div>
                        </div>

                        <!-- 3. Logout -->
                        <a href="{{ url_for('logout') }}"
                            class="flex items-center justify-center w-9 h-9 rounded-full text-gray-400 hover:text-red-500 hover:bg-red-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-1"
                            title="Cerrar Sesión">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                </path>
                            </svg>
                        </a>
                    </div>
                    {% else %}
                    <a href="{{ url_for('login') }}"
                        class="text-indigo-600 hover:text-indigo-700 px-4 py-2 rounded-full border border-indigo-200 hover:bg-indigo-50 text-sm font-semibold transition-all duration-200">
                        Iniciar Sesión
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area: Flex-grow to fill space, scrollable if needed -->
    <main class="flex-1 overflow-y-auto bg-gray-50 relative scroll-smooth focus:scroll-auto">
        <!-- Background decoration -->
        <div class="absolute inset-0 pointer-events-none overflow-hidden" aria-hidden="true">
            <div
                class="absolute -top-24 -left-20 w-96 h-96 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob">
            </div>
            <div
                class="absolute top-0 -right-20 w-96 h-96 bg-indigo-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000">
            </div>
            <div
                class="absolute -bottom-32 left-20 w-96 h-96 bg-pink-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000">
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex flex-col">
            {% block content %}{% endblock %}
        </div>

        {% block footer %}
        <footer class="mt-auto border-t border-gray-200/60 bg-white/80 backdrop-blur-md">
            <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
                <div class="md:flex md:justify-between items-center">
                    <div class="mb-6 md:mb-0 flex items-center gap-3">
                        <img src="{{ url_for('static', filename='images/favicon.svg') }}" alt="Logo"
                            class="h-8 w-auto opacity-80 grayscale hover:grayscale-0 transition-all duration-300">
                        <div>
                            <span class="font-bold text-gray-900 tracking-tight block">Zero System</span>
                            <span class="text-xs text-gray-500">Finanzas Inteligentes</span>
                        </div>
                    </div>

                    <div class="flex gap-8 text-sm">
                        <a href="{{ url_for('dashboard') }}"
                            class="text-gray-500 hover:text-indigo-600 transition-colors">Inicio</a>
                        <a href="{{ url_for('operations') }}"
                            class="text-gray-500 hover:text-indigo-600 transition-colors">Operaciones</a>
                        <a href="{{ url_for('profit_calculator') }}"
                            class="text-gray-500 hover:text-indigo-600 transition-colors">Rentabilidad</a>
                        <a href="{{ url_for('utilities') }}"
                            class="text-gray-500 hover:text-indigo-600 transition-colors">Utilidades</a>
                        <a href="https://wa.me/51935533845" target="_blank"
                            class="text-gray-500 hover:text-green-600 transition-colors flex items-center gap-1">
                            <span>Soporte</span>
                            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WA"
                                class="w-4 h-4 opacity-70">
                        </a>
                    </div>
                </div>

                <div class="mt-8 border-t border-gray-100 pt-8 md:flex md:items-center md:justify-between">
                    <p class="text-xs text-gray-400 text-center md:text-left">
                        &copy; 2026 Zero System. Todos los derechos reservados.
                    </p>
                    <p class="text-xs text-gray-300 text-center md:text-right mt-2 md:mt-0">
                        v2.1.0-stable
                    </p>
                </div>
            </div>
        </footer>
        {% endblock %}
    </main>

    <style>
        @keyframes blob {
            0% {
                transform: translate(0px, 0px) scale(1);
            }

            33% {
                transform: translate(30px, -50px) scale(1.1);
            }

            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }

            100% {
                transform: translate(0px, 0px) scale(1);
            }
        }

        .animate-blob {
            animation: blob 7s infinite;
        }

        .animation-delay-2000 {
            animation-delay: 2s;
        }

        .animation-delay-4000 {
            animation-delay: 4s;
        }
    </style>
</body>

</html>